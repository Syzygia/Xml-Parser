# Мануал по состовлению своего config файла
**Содержание**
- [О json](#пару-слов-об-устройстве-json-формата)
- [Устройство xml фалов Specca](#устройство-xml-фалов-specca)
- [Пишем свой конфиг файл](#пишем-свой-конфиг-файл)
    - [Структура узла json](#структура-узла-json)
    - [Большой Пример](#большой-Пример)

## Пару слов об устройстве Json формата
Объект JSON это формат данных — ключ-значение, который обычно рендерится в фигурных скобках.
Например:
```javascript
{
  "first_name" : "Sammy",
  "last_name" : "Shark",
  "location" : "Ocean",
  "online" : true,
  "followers" : 987
}
```
здесь ключи это те строки что стоят слева, а значение - то что стоит справа.
Также значением может быть какой-либо производный объект заключенный в {},
либо массив каких либов элементов (других объектов, строк и тд.)
Стоит отметить что пары ключ значения расположенные на одном уровне вложености (в одних фигурных скобках, или элементы массива []), отделяются символом ","

## Устройство xml фалов Specca
Вывод программы Specca разделён на несколько xml узлов с рпиблизительно следующей структурой

-mainsection
    -section
    -entry

Или же
-mainsection
    -section
        -entry
Наш конфиг файл будет так же повторять эту структуру, только в json формате,
 только с интересующими вас полями

## Пишем свой конфиг файл
Откроем любой текстовый редактор и в фигурных скобках напишем следующую структуру:

```javascript
{
    "Headers" : ["Pc Name","Core count", "Os"]
}
```
Так мы определили по ключу **Headers** массив строк, который программа будет использовать для
составления заголвков в Excel таблице. То есть здесь мы пишем заголовки для
именно той информации, которую хотим распарсить из xml файла.
**Примечание** информация по заголовку "Pc Name" пишется автомотически из имени xml файла, который мы парсим.

Дальше нужно описать путь от mainsection до желаемого значения из узла entry/section (руководствуемся xml файлом)

Перед этим определим структура узла из xml файла для json файла конфигурации.

### SСтруктура узла json
Все узлы xml данные из которых мы хотим заполучить хранятся по ключу "Nodes"
**Nodes** это массив узлов со следующей json структурой:
```javascript
{
    "NodeName" : "mainsection",
    "title" : "CPU",
    "Childens" : [...]
}
```
**NodeName** это загаловок типа узла из xml файла => возможны следующий варианты:
1.mainsection
2.section
3.entry

**title** сообщает какой именно узел брать указанного типа, возможны два варианты
1.Мы просто указвыаем то что написанно полсе title = ... из xml файла
2. Либо же можно указать порядковый номер этого дочернего элемента относительно родителя (нумерация с нуля)

**Childrens** это массив дочерних эллементов узлов , данные из которых мы хотим вытащить,
У них точно такая же структура json формата, как и у родителя, кроме самых последних (нижних)
У них как раз должен отсутсвовать ключ **Childrens**, так программа поймёт что данные именно этого узла мы хотим получить в Excel.

Также иногда мы хотим получить несколько данных из разных узлов, но сложить их в одну ячейку Excel таблицы, для этого у самых последних *детей* можно указать пару ключ значение "bond": "+"
Пример
```javascript
{
    "NodeName": "entry",
    "title" : "0",
    "bond" : "+"
},
{
    "NodeName": "entry",
    "title" : "1",
    "bond" : "+"
}
```
**Важно!** чтобы те данные которые мы хотим связать, шли друг за другом в json файле

### Большой Пример

Допустим мы хотим получить информацию о количестве ядер процессора.
Рассматриво дерево узлов xml видим что данные лежат в следующем ввиде
```xml
 <mainsection title="CPU" id="2">
    <section title="AMD FX-8350">
        <entry title="Cores" value="8" />
```
Тогла наш массив **Nodes** будет выглядеть следующим образом:

```javascript
"Nodes": [
    {
      "NodeName": "mainsection",
      "title": "CPU",
      "Childrens": [
        {
          "NodeName": "section",
          "title": "0",
          "Childrens": [
            {
              "NodeName": "entry",
              "title": "Cores"
            }]
        }
    }]
```
Теперь рассмотрим как получить имя операционной системы, интересующая нас часть xml файла
выглядит так:

```xml
 <mainsection title="Operating System" id="1">
    <entry>
        <entry title="Model" value="Windows 8" />
        <entry title="Edition" value="Pro" />
        <entry title="Architecture" value=" 64-bit" />
        <entry title="Service Pack" value="" />
    </entry>
```
Значит наш массив Nodes в json будет таким:

```javascript
"Nodes" : [{
      "NodeName": "mainsection",
      "title": "Operating System",
      "Childrens": [
        {
          "NodeName": "entry",
          "title": "0",
          "Childrens": [
            {
              "NodeName": "entry",
              "title": "0",
              "bond" :  "+"
            },
            {
              "NodeName": "entry",
              "title": "1",
              "bond" :  "+"
            },
            {
              "NodeName": "entry",
              "title": "2",
              "bond" :  "+"
            },
            {
              "NodeName": "entry",
              "title": "3",
              "bond" :  "+"
            }
          ]
        }
      ]
    }
  ]
```

